<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>

  <title>Shaker | The distributed data-plane testing tool for OpenStack</title>

  <!-- LIBS -->

  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.js"></script>
  <script type="text/javascript"
          src="https://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.1/handlebars.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/3.2.7/js-yaml.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.js"></script>

  <!-- STYLES -->

  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.4/simplex/bootstrap.min.css">
  <link rel=stylesheet type=text/css
        href="https://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
  <link rel=stylesheet type=text/css
        href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css">
  <link rel='stylesheet' type='text/css'
        href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic&subset=latin,cyrillic'>

  <script type="application/javascript">
    var report = {"scenarios": {"OpenStack VNF test": {"title": "OpenStack VNF test", "description": "In this scenario Shaker launches pairs of instances. Instances are connected to one of 2 tenant networks, which plugged into the router VNF. The traffic goes from one network to the other (L3 east-west).", "deployment": {"template": "vyos_test.hot", "accommodation": ["pair", "best_effort"]}, "execution": {"progression": "quadratic", "tests": [{"title": "Download", "class": "flent", "method": "tcp_download"}, {"title": "Upload", "class": "flent", "method": "tcp_upload"}, {"title": "Bi-directional", "class": "flent", "method": "tcp_bidirectional"}]}, "file_name": "vyos_test.yaml"}}, "records": {"b082c833-ba92-4ba3-bdc7-addb8701cba0": {"status": "ok", "stderr": "", "start": 1618742177.4953125, "finish": 1618742256.3327198, "command": {"type": "script", "data": "zcat `flent -H 40.0.0.25 -l 60 -s 1 tcp_download 2>&1 | grep \"file written\" | grep -Po \"\\./\\S+gz\"`"}, "meta": [["time", "s"], ["ping_icmp", "ms"], ["tcp_download", "Mbits/s"]], "samples": [[0.0, 2.04, null], [1.0, 1.920151985071041, null], [2.0, 0.6544296253180653, null], [3.0, 1.1647120938862698, null], [4.0, 1.4762806652420681, null], [5.0, 1.0557676167565904, null], [6.0, 0.22704181103740417, 12714.94], [7.0, 0.7858098351415047, 12203.61671950817], [8.0, 0.5629115348587191, 11982.169258849235], [9.0, 0.7503361673989433, 11981.065986931324], [10.0, 0.7255547909604836, 12007.825768516064], [11.0, 1.2562919510797808, 11788.811447491646], [12.0, 1.2969792112804415, 11161.466838247776], [13.0, 1.1697282356484748, 11111.167101392746], [14.0, 0.6204290801652136, 10705.240449278353], [15.0, 1.4313801886525737, 9983.777762594224], [16.0, 1.7341536606733692, 9940.278965539934], [17.0, 0.9342930824222335, 10858.157641544343], [18.0, 1.360362456012591, 11934.899815897941], [19.0, 0.7966897160575144, 3839.4978800678246], [20.0, 0.31164756887214645, 11022.185310902596], [21.0, 1.4263456469366789, 10840.518963947296], [22.0, 0.8570359111968302, 10747.686132276058], [23.0, 0.8375666949497134, 10821.158448708058], [24.0, 1.1998968801331609, 8693.218522379399], [25.0, 1.961091544253549, 9995.63668541193], [26.0, 1.4005798268615766, 11432.129786907128], [27.0, 0.55477542182053, 10923.899744567872], [28.0, 1.219711247220462, 10929.691895902157], [29.0, 0.9062702189695134, 10128.570383286476], [30.0, 0.4767603457854055, 10843.375273690224], [31.0, 0.8213787056810742, 10695.148350393772], [32.0, 0.44445330531250904, 10888.728286345005], [33.0, 0.46153885009349793, 10348.295964488983], [34.0, 0.6932843935975357, 10916.528973700999], [35.0, 1.1254708036397274, 8871.97783605814], [36.0, 0.9230646589911009, 7035.436870695932], [37.0, 1.6490906654030146, 9026.999804773332], [38.0, 1.6119810141559738, 10783.106422452927], [39.0, 0.9103662632535892, 10641.979400892258], [40.0, 0.9863632245047297, 10262.854191980363], [41.0, 0.6759928116546277, 9938.707365083696], [42.0, 0.5299170043995325, 10138.922484121322], [43.0, 0.685415029870097, 10480.071088393994], [44.0, 0.6889106009935448, 10329.664409885407], [45.0, 0.6183954846915197, 9172.343150893486], [46.0, 0.9754643347840706, 10036.539684143067], [47.0, 1.0699791712998437, 8833.230562057495], [48.0, 0.756464697571501, 8825.93308794643], [49.0, 0.4939077328540307, 10484.880004048347], [50.0, 0.43406880580324675, 9294.354773638248], [51.0, 0.6505909375395826, 10254.875643854142], [52.0, 0.6356647302371261, 10236.060083010196], [53.0, 0.5059605724707873, 10755.519385247231], [54.0, 0.4151541751199007, 9822.591937088966], [55.0, 0.8631240273909423, 10291.57121263504], [56.0, 0.9518898634123157, 10405.834949977398], [57.0, 0.7133564491289146, 10277.968782536984], [58.0, 2.638812590553669, 9889.638934130668], [59.0, 3.752812085672707, 7903.490814767567], [60.0, 1.1725185783922056, 8070.019643085003], [61.0, 0.7079596348736465, 9598.882033085823], [62.0, 0.9495371680686796, 6630.949541015625], [63.0, 0.9672772218845795, 9797.925632233619], [64.0, 0.918168062831465, 9943.710803592205], [65.0, 0.9801839746325427, 10192.795909030228], [66.0, 1.35721551382588, 10201.15], [67.0, 1.5293229526577994, null], [68.0, 1.457593306463033, null], [69.0, 1.4636868526956006, null]], "schedule": 1618742177.4850085, "id": "b082c833-ba92-4ba3-bdc7-addb8701cba0", "agent": "test_primary_0", "node": "harrypotter", "concurrency": 1, "test": "Download", "executor": "flent", "type": "agent", "scenario": "OpenStack VNF test", "stats": {"ping_icmp": {"max": 3.752812085672707, "min": 0.22704181103740417, "avg": 1.032876018158129, "unit": "ms"}, "tcp_download": {"max": 12714.94, "min": 3839.4978800678246, "avg": 10161.797947559391, "unit": "Mbits/s"}}}, "eaea3864-e9cc-4855-b552-8db8cac8bd3f": {"status": "ok", "stderr": "", "start": 1618742276.0456092, "finish": 1618742351.4801667, "command": {"type": "script", "data": "zcat `flent -H 40.0.0.25 -l 60 -s 1 tcp_upload 2>&1 | grep \"file written\" | grep -Po \"\\./\\S+gz\"`"}, "meta": [["time", "s"], ["ping_icmp", "ms"], ["tcp_upload", "Mbits/s"]], "samples": [[0.0, 0.981, null], [1.0, 0.7761810714214252, null], [2.0, 1.4104061477436236, null], [3.0, 1.8264241316948937, null], [4.0, 1.4053041367457029, null], [5.0, 1.090971365812348, null], [6.0, 0.2122214548012904, 9558.29], [7.0, 0.9090165735948568, 10664.532319598198], [8.0, 1.337154968441118, 9369.728118498324], [9.0, 1.0167044894951713, 9316.601463937759], [10.0, 0.7463119003130997, 10609.181063797474], [11.0, 1.01257222167942, 10693.903392760752], [12.0, 0.7336691497467339, 10416.840542740822], [13.0, 1.472789903460368, 10049.299841093172], [14.0, 1.1310480077853682, 10030.882919659614], [15.0, 1.2017432035106628, 9944.011832017897], [16.0, 1.1637846368181872, 9274.327664706707], [17.0, 0.673292176181825, 9748.973539717197], [18.0, 0.9487516691977239, 9936.04560911417], [19.0, 0.8308155294646656, 9328.555021021366], [20.0, 1.0511833407325455, 8836.245908243656], [21.0, 1.1333037944455304, 8895.739806440304], [22.0, 0.8551528944556577, 8859.386940704284], [23.0, 0.7545690327180206, 8737.683198623658], [24.0, 1.9966387300722221, 9131.733173642158], [25.0, 1.0832426866160478, 8845.052341914177], [26.0, 2.0861126766790017, 9967.648921466676], [27.0, 0.9527336088690628, 8616.01465866089], [28.0, 1.1354766877452689, 7523.361498202452], [29.0, 1.3517176860627809, 6961.14082993708], [30.0, 0.6580275015192992, 7232.0058465957645], [31.0, 0.47000053369906275, 8812.804247252941], [32.0, 1.5225520528778171, 6158.086480648517], [33.0, 1.2673383517651495, 7453.46529914856], [34.0, 0.6601186320385553, 9605.45590585947], [35.0, 1.1526859432231502, 8278.675324161053], [36.0, 1.8056100639637354, 8025.847046632767], [37.0, 1.5724162882624282, 6949.541896180492], [38.0, 1.2748163152402028, 7465.5240776109695], [39.0, 1.6327871131263407, 7067.212126777243], [40.0, 1.8977219491715327, 8655.034151344298], [41.0, 1.598541439173466, 6491.208585748673], [42.0, 2.3426056486108706, 5640.305771760941], [43.0, 1.353083614774669, 7807.1413016319275], [44.0, 0.5906403494601367, 4755.971362334816], [45.0, 0.7980193916037557, 7694.767228405475], [46.0, 1.2216193897148413, 5899.314542201868], [47.0, 5.726522411479395, 4469.7177132203], [48.0, 3.076233910335392, 4627.919860076904], [49.0, 2.3793009295590055, 4815.240375390255], [50.0, 4.318882597892065, 4023.8418701397572], [51.0, 1.622876067960933, 5841.357218379975], [52.0, 0.6285348900096309, 6705.069120668581], [53.0, 0.86494082676074, 7796.133698301315], [54.0, 3.178077908483582, 7627.4808795475965], [55.0, 2.759788980523334, 8570.508295717238], [56.0, 2.1449648771026153, 6830.273530142307], [57.0, 1.5489033993205554, 6538.69389292717], [58.0, 1.3, 7023.017260057926], [59.0, 0.8552343319445153, 7591.446193053722], [60.0, 0.3760596355635268, 8341.743913915157], [61.0, 0.23234629791777286, 8594.702493691444], [62.0, 1.3680745624707424, 8768.907585914136], [63.0, 1.581015664910448, 6016.061885271072], [64.0, 0.9057156151602166, 8449.489336426257], [65.0, 0.7424897413142558, 9487.00492558715], [66.0, 1.2005210506401154, 9503.14], [67.0, 0.8063392053858705, null], [68.0, 0.436193091802221, null], [69.0, 1.1646120438498415, null]], "schedule": 1618742276.035601, "id": "eaea3864-e9cc-4855-b552-8db8cac8bd3f", "agent": "test_primary_0", "node": "harrypotter", "concurrency": 1, "test": "Upload", "executor": "flent", "type": "agent", "scenario": "OpenStack VNF test", "stats": {"ping_icmp": {"max": 5.726522411479395, "min": 0.2122214548012904, "avg": 1.3473786642130916, "unit": "ms"}, "tcp_upload": {"max": 10693.903392760752, "min": 4023.8418701397572, "avg": 8048.021177856112, "unit": "Mbits/s"}}}, "fce8f421-fa61-4804-a273-d0d9c400ffe5": {"status": "ok", "stderr": "", "start": 1618742371.1927063, "finish": 1618742446.6678448, "command": {"type": "script", "data": "zcat `flent -H 40.0.0.25 -l 60 -s 1 tcp_bidirectional 2>&1 | grep \"file written\" | grep -Po \"\\./\\S+gz\"`"}, "meta": [["time", "s"], ["ping_icmp", "ms"], ["tcp_download", "Mbits/s"], ["tcp_upload", "Mbits/s"]], "samples": [[0.0, 1.02, null, null], [1.0, 0.5193149049951131, null, null], [2.0, 1.4665719798281183, null, null], [3.0, 1.4701599222294541, null, null], [4.0, 1.499456184038387, null, null], [5.0, 0.40393043043555865, null, null], [6.0, 0.15922250518452252, 5257.42, 5306.43], [7.0, 0.27213212555392263, 5773.312180562019, 5837.432987189704], [8.0, 0.6164286564775665, 5960.042428973517, 5557.64296790653], [9.0, 1.73774929460552, 5467.654532270431, 5254.14757345054], [10.0, 0.8839902685796671, 5171.760755808354, 4909.777865028382], [11.0, 1.1666985912212093, 5350.904428633764, 5191.3216434192655], [12.0, 0.6544601015642031, 5502.906316382669, 4784.595209827423], [13.0, 1.981076885279436, 5555.214746384363, 5463.173596320971], [14.0, 1.7635912359605754, 5581.485098819732, 5453.4282263565065], [15.0, 2.3060820582397907, 5292.610173540115, 4805.04952028513], [16.0, 1.9972319448155786, 5373.696838111877, 4594.089659228133], [17.0, 1.252600736867783, 4660.033058109283, 4477.738090870381], [18.0, 0.3945535588991784, 4700.521335182365, 4560.120111250096], [19.0, 0.8442299474431476, 4974.119787047604, 4756.771839413643], [20.0, 1.8172642154477172, 5269.9730654716495, 5129.37817223207], [21.0, 1.5910190999062308, 5493.099325492117, 5239.0802132415765], [22.0, 0.6474645717045662, 5410.467144470215, 4940.837431030273], [23.0, 0.4946305739042352, 5225.713045082092, 4959.783642730713], [24.0, 0.9935702772524903, 5196.950299377441, 4924.117298495795], [25.0, 1.1581788978262046, 2181.3584890440934, 2047.7742492138555], [26.0, 1.0533645512712138, 2039.9593533682826, 2032.856354074478], [27.0, 0.8412086402371884, 5081.957174723633, 5056.894349429607], [28.0, 1.4061603023988696, 4694.612595148086, 4694.389838869944], [29.0, 2.6575889390554663, 4078.507969112396, 4058.0452510094647], [30.0, 2.6323619315207507, 4112.994164004326, 4091.2146972334167], [31.0, 1.9806214095268528, 4665.936671823679, 4616.718931903646], [32.0, 2.3768393073677987, 4785.776977386475, 4594.631507483984], [33.0, 1.7615568664893226, 4813.07954018116, 4587.242882084847], [34.0, 1.5013467305354822, 4914.345497933905, 4868.9080759143835], [35.0, 2.0584196462436153, 5085.304823405742, 4941.600378220081], [36.0, 1.3671010558760677, 5232.8815010428425, 4953.879894826412], [37.0, 0.3827108527467642, 5213.401827349663, 4599.809675252438], [38.0, 0.9303309046534165, 4881.064497210669, 4405.660410941368], [39.0, 1.6705090857639522, 4503.166073822975, 4244.895132796764], [40.0, 2.200612713290418, 4712.279735191013, 4500.462377722263], [41.0, 2.260192047563137, 4168.0402824226085, 4016.680250168672], [42.0, 2.835741887963301, 3820.4353721809384, 3675.2226233994784], [43.0, 1.361082603535431, 4267.505968599182, 4111.932352545517], [44.0, 2.9431617080460453, 4603.622996990681, 4585.98041223526], [45.0, 5.519755358585789, 4778.6447707247735, 4606.162202119827], [46.0, 4.137858203923051, 4775.824080393314, 4620.8313257312775], [47.0, 1.750375024570666, 4741.060689489841, 4691.877095251083], [48.0, 3.57521241529894, 4738.887709811937, 4582.318927892784], [49.0, 1.9096982332748011, 4508.4878017807005, 4102.297726869583], [50.0, 0.8567792225184783, 4975.500947589874, 4584.845216269493], [51.0, 0.33070902042381606, 4997.113805689812, 4990.967410802841], [52.0, 0.7471319235241711, 4837.869186809063, 4879.730769880086], [53.0, 2.0795720483160975, 4657.725459794998, 4418.729272180517], [54.0, 2.911136515739619, 4596.137062166042, 4344.605875873566], [55.0, 2.4408401133147177, 4605.3721501481095, 4351.138019208908], [56.0, 1.3504105889956237, 4687.859313247204, 4568.225089273453], [57.0, 1.2388686594237432, 4564.721521348209, 4735.114349832535], [58.0, 1.1616414203749692, 4745.536766028405, 4568.016925359545], [59.0, 2.42822803340415, 4739.235835418702, 4631.595109145641], [60.0, 2.8866579894876954, 4768.4073378289095, 4667.599325838089], [61.0, 1.1242688606449327, 4507.289623727798, 4328.19180378437], [62.0, 0.6505500994498691, 4343.592296886444, 4001.331558880806], [63.0, 1.3626279123457996, 4727.95175775528, 4544.490543723017], [64.0, 2.0730546078805903, 4926.759493608474, 4665.380590873072], [65.0, 3.473917873300735, 4521.27723089688, 4243.412462329169], [66.0, 0.7688565771152087, 4447.96, 4152.98], [67.0, 1.4444299604279802, null, null], [68.0, 1.446571311098761, null, null], [69.0, 0.8348557232741122, null, null]], "schedule": 1618742371.1827447, "id": "fce8f421-fa61-4804-a273-d0d9c400ffe5", "agent": "test_primary_0", "node": "harrypotter", "concurrency": 1, "test": "Bi-directional", "executor": "flent", "type": "agent", "scenario": "OpenStack VNF test", "stats": {"ping_icmp": {"max": 5.519755358585789, "min": 0.15922250518452252, "avg": 1.5976646835579942, "unit": "ms"}, "tcp_download": {"max": 5960.042428973517, "min": 2039.9593533682826, "avg": 4791.267719865685, "unit": "Mbits/s"}, "tcp_upload": {"max": 5837.432987189704, "min": 2032.856354074478, "avg": 4591.959955651191, "unit": "Mbits/s"}}}, "156b6608-b594-41db-a607-cb86f0e01a1c": {"stats": {"ping_icmp": {"unit": "ms", "avg": 1.032876018158129, "max": 3.752812085672707, "min": 0.22704181103740417}, "tcp_download": {"unit": "Mbits/s", "avg": 10161.797947559391, "max": 12714.94, "min": 3839.4978800678246}}, "node_chart": [["x", "harrypotter"], ["Avg ping_icmp, ms", 1.032876018158129], ["Max ping_icmp, ms", 3.752812085672707], ["Min ping_icmp, ms", 0.22704181103740417], ["Avg tcp_download, Mbits/s", 10161.797947559391], ["Max tcp_download, Mbits/s", 12714.94], ["Min tcp_download, Mbits/s", 3839.4978800678246]], "id": "156b6608-b594-41db-a607-cb86f0e01a1c", "scenario": "OpenStack VNF test", "test": "Download", "concurrency": 1, "type": "concurrency"}, "ad2e0c94-d091-4d72-a129-9d622c3311fd": {"chart": [["concurrency", 1], ["ping_icmp", 1.032876018158129], ["tcp_download", 10161.797947559391]], "meta": [["concurrency", ""], ["ping_icmp", "ms"], ["tcp_download", "Mbits/s"]], "id": "ad2e0c94-d091-4d72-a129-9d622c3311fd", "scenario": "OpenStack VNF test", "test": "Download", "type": "test"}, "30811381-f6f2-42a5-b0ea-459354b1b08a": {"stats": {"ping_icmp": {"unit": "ms", "avg": 1.3473786642130916, "max": 5.726522411479395, "min": 0.2122214548012904}, "tcp_upload": {"unit": "Mbits/s", "avg": 8048.021177856112, "max": 10693.903392760752, "min": 4023.8418701397572}}, "node_chart": [["x", "harrypotter"], ["Avg ping_icmp, ms", 1.3473786642130916], ["Max ping_icmp, ms", 5.726522411479395], ["Min ping_icmp, ms", 0.2122214548012904], ["Avg tcp_upload, Mbits/s", 8048.021177856112], ["Max tcp_upload, Mbits/s", 10693.903392760752], ["Min tcp_upload, Mbits/s", 4023.8418701397572]], "id": "30811381-f6f2-42a5-b0ea-459354b1b08a", "scenario": "OpenStack VNF test", "test": "Upload", "concurrency": 1, "type": "concurrency"}, "bd9aa5ff-54d2-4f3b-aae4-f03f8854699a": {"chart": [["concurrency", 1], ["ping_icmp", 1.3473786642130916], ["tcp_upload", 8048.021177856112]], "meta": [["concurrency", ""], ["ping_icmp", "ms"], ["tcp_upload", "Mbits/s"]], "id": "bd9aa5ff-54d2-4f3b-aae4-f03f8854699a", "scenario": "OpenStack VNF test", "test": "Upload", "type": "test"}, "a0cd3142-f0c0-40c0-a6ef-9caf9c0af67d": {"stats": {"ping_icmp": {"unit": "ms", "avg": 1.5976646835579942, "max": 5.519755358585789, "min": 0.15922250518452252}, "tcp_download": {"unit": "Mbits/s", "avg": 4791.267719865685, "max": 5960.042428973517, "min": 2039.9593533682826}, "tcp_upload": {"unit": "Mbits/s", "avg": 4591.959955651191, "max": 5837.432987189704, "min": 2032.856354074478}}, "node_chart": [["x", "harrypotter"], ["Avg ping_icmp, ms", 1.5976646835579942], ["Max ping_icmp, ms", 5.519755358585789], ["Min ping_icmp, ms", 0.15922250518452252], ["Avg tcp_download, Mbits/s", 4791.267719865685], ["Max tcp_download, Mbits/s", 5960.042428973517], ["Min tcp_download, Mbits/s", 2039.9593533682826], ["Avg tcp_upload, Mbits/s", 4591.959955651191], ["Max tcp_upload, Mbits/s", 5837.432987189704], ["Min tcp_upload, Mbits/s", 2032.856354074478]], "id": "a0cd3142-f0c0-40c0-a6ef-9caf9c0af67d", "scenario": "OpenStack VNF test", "test": "Bi-directional", "concurrency": 1, "type": "concurrency"}, "6f941a9d-070b-4b23-9970-7224700c813f": {"chart": [["concurrency", 1], ["ping_icmp", 1.5976646835579942], ["tcp_download", 4791.267719865685], ["tcp_upload", 4591.959955651191]], "meta": [["concurrency", ""], ["ping_icmp", "ms"], ["tcp_download", "Mbits/s"], ["tcp_upload", "Mbits/s"]], "id": "6f941a9d-070b-4b23-9970-7224700c813f", "scenario": "OpenStack VNF test", "test": "Bi-directional", "type": "test"}}, "agents": {"test_primary_0": {"id": "test_primary_0", "mode": "primary", "minion_id": "test_minion_0", "node": "harrypotter", "zone": "nova", "availability_zone": "nova:harrypotter", "ip": "30.0.0.25", "minion": {"id": "test_minion_0", "mode": "minion", "primary_id": "test_primary_0", "node": "hermionegranger", "zone": "nova", "availability_zone": "nova:hermionegranger", "ip": "40.0.0.25"}}, "test_minion_0": {"id": "test_minion_0", "mode": "minion", "primary_id": "test_primary_0", "node": "hermionegranger", "zone": "nova", "availability_zone": "nova:hermionegranger", "ip": "40.0.0.25", "primary": {"id": "test_primary_0", "mode": "primary", "minion_id": "test_minion_0", "node": "harrypotter", "zone": "nova", "availability_zone": "nova:harrypotter", "ip": "30.0.0.25"}}}, "tests": {"Download": {"title": "Download", "class": "flent", "method": "tcp_download"}, "Upload": {"title": "Upload", "class": "flent", "method": "tcp_upload"}, "Bi-directional": {"title": "Bi-directional", "class": "flent", "method": "tcp_bidirectional"}}, "sla": []};
  </script>

  <script type="text/javascript">
    "use strict";

    $(function () {

      var fields = ["scenario", "test", "concurrency", "node", "agent"];
      var state = {
        scenario: "",
        test: "",
        concurrency: "",
        node: "",
        agent: ""
      };
      var tablePageSize = 10;

      // compiled templates
      var scenario_source_template = Handlebars.compile($("#scenario_source_template").html());
      var test_specification_template = Handlebars.compile($("#test_specification_template").html());
      var agents_table_template = Handlebars.compile($("#agents_table_template").html());
      var records_table_template = Handlebars.compile($("#records_table_template").html());
      var executor_template = Handlebars.compile($("#executor_template").html());
      var concurrency_summary_template = Handlebars.compile($("#concurrency_summary_template").html());
      var test_summary_template = Handlebars.compile($("#test_summary_template").html());
      var sla_table_template = Handlebars.compile($("#sla_table_template").html());
      var errors_template = Handlebars.compile($("#errors_template").html());

      function concatenate(strings) {
        // returns strings concatenated via comma (like join() but omits empty strings)
        var f = false;
        var result = "";
        $.each(strings, function (_i, string) {
          if (string.length > 0) {
            if (f) result += ", ";
            result += string;
            f = true;
          }
        });
        return result;
      }

      function initSingleSelector(name, values) {
        var selectorId = "#" + name + "_selector";

        var selector_inst = $(selectorId);
        selector_inst.empty();
        selector_inst.append($("<option>", {
          style: "font-style: italic; text-decoration: underline;",
          value: "",
          text: selector_inst.data('placeholder')
        }));

        $.each(values, function (key, item) {
          selector_inst.append($('<option>', {
            value: item, //(key + 1),
            text: item
          }));
        });

        selector_inst.val(state[name]);

        selector_inst.
            on("change", function (e) {
              state[name] = this.value;

              // convert state -> url
              var tokens = [];
              $.each(fields.sort(), function (i, field) {
                if (state[field] != "") {
                  tokens.push(field + "=" + state[field]);
                }
              });
              window.location.href = "#" + tokens.join(":");
            });
      }

      function getFieldValues(field, records) {
        var values_set = {};

        $.each(records, function (j, record) {
          if (record[field]) {
            values_set["" + record[field]] = true;
          }
        });

        return $.map(values_set, function (_i, value) {
          return value;
        }).sort();
      }

      function updateSelectors() {
        $.each(fields, function (i, field) {
          var values = getFieldValues(field, filterRecords(report.records, null, field));
          console.log(values);
          initSingleSelector(field, values);
        });
      }

      function filterRecords(records, type, except_field) {
        var res = [];
        $.each(records, function(_i, record){
          if (!type || typeof type === 'undefined' || record.type == type) {
            var flag = true;
            $.each(state, function (key, value) {
              if (key != except_field && value) {
                flag &= record[key] == value;
              }
            });
            if (flag) {
              res.push(record);
            }
          }
        });
        return res;
      }

      function getAgentsByIds(agent_ids) {
        var agents = [];
        $.each(agent_ids, function(agent_id){
          agents.push(report.agents[agent_id]);
        });
        return agents;
      }

      /* Template Rendering Funcs */

      function showScenarioSource(contentArea, scenario) {
        contentArea.append(scenario_source_template(
            {data: jsyaml.safeDump(scenario)}));
      }

      function showTestSpecification(contentArea, test) {
        contentArea.append(test_specification_template(
            {data: jsyaml.safeDump(test)}
        ))
      }

      function showAgentRecord(contentArea, record) {
        var chart_id = "chart_" + Math.round(Math.random() * 10000);
        var ext_options = {
          command_yaml: jsyaml.safeDump(record["command"]),
          chart_id: chart_id};
        if (record["stats"]) {
          ext_options["stats_yaml"] = jsyaml.safeDump(record["stats"]);
        }
        if ((record["start"]) && (record["finish"])) {
          ext_options["time_info"] = jsyaml.safeDump({
            "start": new Date(record["start"] * 1000).toISOString(),
            "finish": new Date(record["finish"] * 1000).toISOString()
          });
        }
        contentArea.append(executor_template(
            {record: $.extend({}, record, ext_options)}
        ));
        if (record["samples"]) {
          var meta = record["meta"];
          var axes = [];
          axes[meta[1][0]] = 'y';
          var axis = {
            x: {label: concatenate(meta[0])},
            y: {label: concatenate(meta[1]), min: 0}
          };
          if (meta.length > 2) {
            axes[meta[2][0]] = 'y2';
            axis['y2'] = {label: concatenate(meta[2]), min: 0, show: true}
          }

          var chart = [];
          $.each(meta, function(_i, meta_item){  // row titles
            chart.push([meta_item[0]]);
          });
          var samples = record["samples"];
          for (var i=0; i < samples.length; i++) {
            var point = samples[i];
            for (var j=0; j < point.length; j++) {
              chart[j].push(point[j]);
            }
          }

          c3.generate({
            bindto: "#" + chart_id,
            data: {
              x: 'time',
              columns: chart,
              axes: axes
            },
            axis: axis
          });
        }
      }

      function showConcurrencySummary(contentArea, record) {
        var chart_id = "chart_" + Math.round(Math.random() * 10000);
        var node_chart_id = "node_chart_" + Math.round(Math.random() * 10000);
        var ext_options = { chart_id: chart_id, node_chart_id: node_chart_id };
        if (record["stats"]) {
          ext_options["stats_yaml"] = jsyaml.safeDump(record["stats"]);
        }
        console.log(record);
        contentArea.append(concurrency_summary_template(
            {record: $.extend({}, record, ext_options)}
        ));
        if (record["node_chart"]) {
          c3.generate({
            bindto: "#" + node_chart_id,
            data: {
              x: 'x',
              columns: record["node_chart"],
              type: 'step',
              order: null
            },
            axis: {
              x: { type: 'category' }
            }
          });
        }
      }

      function showTestSummary(contentArea, record) {
        console.log(record);
        var chart_id = "chart_" + Math.round(Math.random() * 10000);
        var ext_options = { chart_id: chart_id };
        if (record["stats"]) {
          ext_options["stats_yaml"] = jsyaml.safeDump(record["stats"]);
        }
        contentArea.append(test_summary_template(
            {record: $.extend({}, record, ext_options)}
        ));
        if (record["chart"]) {
          var meta = record["meta"];
          var axes = [];
          axes[meta[1][0]] = 'y';
          var axis = {
            x: {label: concatenate(meta[0])},
            y: {label: concatenate(meta[1]), min: 0}
          };
          if (meta.length > 2) {
            axes[meta[2][0]] = 'y2';
            axis['y2'] = {label: concatenate(meta[2]), min: 0, show: true}
          }

          c3.generate({
            bindto: "#" + chart_id,
            data: {
              x: 'concurrency',
              columns: record["chart"],
              axes: axes
            },
            axis: axis
          });
        }
      }

      function showAgentsTable(contentArea, filteredRecords) {
        var agent_ids = {};
        $.each(filteredRecords, function(_i, record){
          if (record.agent) {
            agent_ids[record.agent] = true;
          }
        });

        var agents = getAgentsByIds(agent_ids);
        if (agents.length == 0) return;

        // add minion agents
        var minion_agent_ids = {};
        $.each(agents, function(_i, agent){
          if (agent.minion_id) {
            minion_agent_ids[agent.minion_id] = true;
          }
        });
        agents = $.merge(agents, getAgentsByIds(minion_agent_ids));

        contentArea.append(agents_table_template({
          agents: agents,
          table_id: "agents_table"
        }));
        $("#agents_table").dataTable({
          "autoWidth": true,
          "paging": false,
          "ordering": true,
          "info": false
        });
      }

      function makeURL(record, s) {
        var extra = {};
        extra[s] = record[s];
        return "#" + $.map($.extend({}, state, extra), function (val, index) {
          return val? (index + "=" + val) : null;
        }).join(":")
      }

      function showRecordsTable(contentArea, filteredRecords) {
        $.each(filteredRecords, function(_i, record) {
          $.each(fields, function(_j, field){
            if (record[field]) {
              record[field + "_url"] = makeURL(record, field);
            }
          });
        });

        contentArea.append(records_table_template({
          records: filteredRecords,
          table_id: "records_table"
        }));
        $("#records_table").dataTable({
          autoWidth: true,
          paging: filteredRecords.length > tablePageSize,
          ordering: true,
          info: false,
          searching: filteredRecords.length > tablePageSize
        });
      }

      function showSlaTable(contentArea, records) {
        if (records.length == 0) return;

        contentArea.append(sla_table_template({
          records: records,
          table_id: "sla_table"
        }));
        $("#records_table").dataTable({
          autoWidth: true,
          paging: records.length > tablePageSize,
          ordering: true,
          info: false,
          searching: records.length > tablePageSize
        });
      }

      function showErrors(contentArea, records) {
        if (records.length == 0) return;

        contentArea.append(errors_template({
          records: records,
          table_id: "errors_list"
        }));
      }

      /* Update cycle */

      function update() {
        var filteredRecords = filterRecords(report.records);
        console.log(filteredRecords);
        var slaRecords = [];
        var errorRecords = [];
        $.each(filterRecords(report.records), function(_i, record) {
          if (record["sla_info"]) {
            slaRecords.push(record);
          }
          if (record["is_status_error"]) {
            errorRecords.push(record);
          }
        });

        var contentArea = $("#content_area");
        contentArea.empty();

        updateSelectors();

        showRecordsTable(contentArea, filteredRecords);
        showSlaTable(contentArea, slaRecords);
        showErrors(contentArea, errorRecords);

        if (state["scenario"] != "" && state["test"] != "" &&
                state["concurrency"] != "" &&
                state["agent"] != "") {
          showAgentRecord(contentArea, filteredRecords[0]);
        }
        if (state["scenario"] != "" && state["test"] != "" &&
                state["concurrency"] != "" && state["node"] == "" &&
                state["agent"] == "") {
          var agg_recs = filterRecords(report.records, "concurrency");
          if (agg_recs.length > 0) {
            showConcurrencySummary(contentArea, agg_recs[0]);
          }
        }
        if (state["scenario"] != "" && state["test"] != "" &&
                state["concurrency"] == "" && state["node"] == "" &&
                state["agent"] == "") {
          var test_recs = filterRecords(report.records, "test");
          if (test_recs.length > 0) {
            showTestSummary(contentArea, test_recs[0]);
          }
        }
        if (state["test"] != "") {
          showTestSpecification(contentArea, report.tests[state["test"]]);
        }
        if (state["agent"] == "") {
          showAgentsTable(contentArea, filteredRecords);
        }
        if (state["scenario"] != "") {
          showScenarioSource(contentArea, report.scenarios[state["scenario"]]);
        }
      }

      function parseUrlToState() {
        var hashUrl = window.location.hash.substr(1);

        $.each(hashUrl.split(":"), function (_i, pair) {
          var kv = pair.split("=");
          if (kv.length == 2) {
            state[kv[0]] = decodeURIComponent(kv[1]);
          }
        });
      }

      // entry-point
      parseUrlToState();
      console.log(state);

      // change the status of tests that have sla failures
      // to "fail", only if they were previously marked "ok"
      $.each(report.sla, function(_i, sla) {
        if (sla.state == "FAIL" && report.records[sla.record].status == "ok") {
          report.records[sla.record].status = "fail";
        }
      });
      // pre-process records
      $.each(report.records, function(_i, record) {
        if (record.status) {
          record["is_status_ok"] = record.status == "ok";
          record["is_status_lost"] = record.status == "lost";
          record["is_status_interrupted"] = record.status == "interrupted";
          record["is_status_error"] = record.status == "error";
          record["is_status_fail"] = record.status == "fail";
        }
      });

      // auto-select filters with 1 option
      $.each(fields, function(_i, field) {
        var values = getFieldValues(field, report.records);
        if (values.length == 1) {
          state[field] = values[0];
        }
      });

      update();

      $(window).on('hashchange', function() {
        parseUrlToState();
        update()
      });

      $('[data-toggle="tooltip"]').tooltip();
    });
  </script>

  <style type="text/css">
  </style>

</head>

<body>

<div class="container" id="container">
  <div class="row text-center">
    <h1>Shaker | The Report</h1>
  </div>
  <hr>
  <div class="row">
    <div class="col-md-2">
      <label for="scenario_selector" title="Scenario name">Scenario</label>
      <select id="scenario_selector" class="form-control" data-placeholder="- Any scenario -"></select>
    </div>
    <div class="col-md-2">
      <label for="test_selector" title="Test name">Test Case</label>
      <select id="test_selector" class="form-control" data-placeholder="- Any test case -"></select>
    </div>
    <div class="col-md-2">
      <label for="concurrency_selector" title="Concurrency">Concurrency</label>
      <select id="concurrency_selector" class="form-control" data-placeholder="- Any concurrency -"></select>
    </div>
    <div class="col-md-2">
      <label for="node_selector" title="Host / Compute node">Host</label>
      <select id="node_selector" class="form-control" data-placeholder="- Any node -"></select>
    </div>
    <div class="col-md-2">
      <label for="agent_selector" title="Agent">Agent</label>
      <select id="agent_selector" class="form-control" data-placeholder="- Any agent -"></select>
    </div>
  </div>

  <div id="content_area" class="row">
    <!-- Container for the screen content -->
  </div>

  <div id="footer" class="row">&nbsp;</div>
</div>

<!-- TEMPLATES --------------------------------------------------------------->

<!-- Scenario File -->
<script id="scenario_source_template" type="text/x-handlebars-template">
  <h3>Scenario</h3>
  <pre>{{ data }}</pre>
</script>

<!-- Test Specification -->
<script id="test_specification_template" type="text/x-handlebars-template">
  <h3>Test Specification</h3>
  <pre>{{ data }}</pre>
</script>

<!-- Executor Result -->
<script id="executor_template" type="text/x-handlebars-template">
  <h3>Execution Summary</h3>
  {{#with record}}
  <div id="{{ chart_id }}"></div>
  {{#if is_status_ok}}<span class="label label-success"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span>success</span>{{/if}}
  {{#if is_status_lost}}<span class="label label-danger"><span class="glyphicon glyphicon-alert" aria-hidden="true"></span>lost</span>{{/if}}
  {{#if is_status_interrupted}}<span class="label label-warning"><span class="glyphicon glyphicon-stop" aria-hidden="true"></span>interrupted</span>{{/if}}
  {{#if is_status_error}}<span class="label label-danger"><span class="glyphicon glyphicon-alert" aria-hidden="true"></span>error</span>{{/if}}
  {{#if is_status_fail}}<span class="label label-danger"><span class="glyphicon glyphicon-alert" aria-hidden="true"></span>sla fail</span>{{/if}}
  {{#if stats_yaml}}
    <h4>Stats</h4>
    <pre>{{ stats_yaml }}</pre>
  {{/if}}
  {{#if time_info}}
    <h4>Time Info</h4>
    <pre>{{ time_info }}</pre>
  {{/if}}
  <h4>Command</h4>
  <pre>{{ command_yaml }}</pre>
  {{#if stdout}}
    <h4>Stdout</h4>
    <pre>{{ stdout }}</pre>
  {{/if}}
  {{#if verbose}}
    <h4>Verbose Info</h4>
    <pre>{{ verbose }}</pre>
  {{/if}}
  {{#if stderr}}
    <h4>Stderr</h4>
    <pre>{{ stderr }}</pre>
  {{/if}}
  {{/with}}
</script>

<!-- Concurrency summary -->
<script id="concurrency_summary_template" type="text/x-handlebars-template">
  {{#with record}}
  <div id="{{ chart_id  }}"></div>
  <h3>Per-node chart</h3>
  <div id="{{ node_chart_id  }}"></div>
  <h3>Stats</h3>
  <pre>{{ stats_yaml }}</pre>
  {{/with}}
</script>

<!-- Test summary -->
<script id="test_summary_template" type="text/x-handlebars-template">
  {{#with record}}
  <div id="{{ chart_id   }}"></div>
  {{#if stats_yaml}}
    <h3>Stats</h3>
    <pre>{{ stats_yaml }}</pre>
  {{/if}}
  {{/with}}
</script>

<!-- Records Table -->
<script id="records_table_template" type="text/x-handlebars-template">
  <h3>Records</h3>
  <table class="table table-striped" id="{{ table_id  }}">
    <thead>
    <tr>
      <th>Scenario</th>
      <th>Test Case</th>
      <th>Concurrency</th>
      <th>Host / Compute Node</th>
      <th>Agent</th>
      <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {{#records}}
    <tr>
      <td><a href="{{ scenario_url }}">{{ scenario }}</a></td>
      <td><a href="{{ test_url }}">{{ test }}</a></td>
      <td><a href="{{ concurrency_url }}">{{ concurrency }}</a></td>
      <td><a href="{{ node_url }}">{{ node }}</a></td>
      <td><a href="{{ agent_url }}">{{ agent }}</a></td>
      <td>
        {{#if is_status_ok }}
          <span class="label label-success">
            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
            success
          </span>
        {{/if}}
        {{#if is_status_lost }}
          <span class="label label-danger">
            <span class="glyphicon glyphicon-alert" aria-hidden="true"></span>
            lost
          </span>
        {{/if}}
        {{#if is_status_interrupted }}
          <span class="label label-warning">
            <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
            interrupted
          </span>
        {{/if}}
        {{#if is_status_error }}
          <span class="label label-danger">
            <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
            error
          </span>
        {{/if}}
        {{#if is_status_fail }}
          <span class="label label-danger">
            <span class="glyphicon glyphicon-alert" aria-hidden="true"></span>
            sla fail
          </span>
        {{/if}}
      </td>
    </tr>
    {{/records}}
    </tbody>
  </table>
</script>

<!-- Agents List -->
<script id="agents_table_template" type="text/x-handlebars-template">
  <h3>Agents</h3>
  <table class="table table-striped" id="{{ table_id }}">
    <thead>
    <tr>
      <th>Agent</th>
      <th>Mode</th>
      <th>IP</th>
      <th>Node</th>
      <th>AZ</th>
    </tr>
    </thead>
    <tbody>
    {{#agents}}
    <tr>
      <td>{{ id }}</td>
      <td>{{ mode }}</td>
      <td>{{ ip }}</td>
      <td>{{ node }}</td>
      <td>{{ zone }}</td>
    </tr>
    {{/agents}}
    </tbody>
  </table>
</script>

<!-- SLA List -->
<script id="sla_table_template" type="text/x-handlebars-template">
  <h3>Agents</h3>
  <table class="table table-striped" id="{{  table_id }}">
    <thead>
    <tr>
      <th>Condition</th>
      <th>Location</th>
      <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {{#records}}
    <tr>
      <td>{{ sla }}</td>
      <td>{{ location }}</td>
      <td>
        {{#if is_status_ok }}
          <span class="text-success">
            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
            {{ status }}
          </span>
        {{else}}
          <span class="text-danger">
            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            {{ status }}
          </span>
        {{/if}}
      </td>
    </tr>
    {{/records}}
    </tbody>
  </table>
</script>

<!-- Errors -->
<script id="errors_template" type="text/x-handlebars-template">
  <h3>Errors</h3>
  <div class="text-danger">
    <ul>
    {{#records}}
      <li>{{ info }}<br/>{{ stderr }}{{ traceback }}</li>
    {{/records}}
    </ul>
  </div>
</script>

</body>
</html>