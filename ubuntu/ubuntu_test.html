<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>

  <title>Shaker | The distributed data-plane testing tool for OpenStack</title>

  <!-- LIBS -->

  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.js"></script>
  <script type="text/javascript"
          src="https://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.1/handlebars.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/3.2.7/js-yaml.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
  <script type="application/javascript"
          src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.js"></script>

  <!-- STYLES -->

  <link rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.4/simplex/bootstrap.min.css">
  <link rel=stylesheet type=text/css
        href="https://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
  <link rel=stylesheet type=text/css
        href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.css">
  <link rel='stylesheet' type='text/css'
        href='http://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic&subset=latin,cyrillic'>

  <script type="application/javascript">
    var report = {"scenarios": {"OpenStack VNF test": {"title": "OpenStack VNF test", "description": "In this scenario Shaker launches pairs of instances. Instances are connected to one of 2 tenant networks, which plugged into the router VNF. The traffic goes from one network to the other (L3 east-west).", "deployment": {"template": "ubuntu_test.hot", "accommodation": ["pair", "best_effort"]}, "execution": {"progression": "quadratic", "tests": [{"title": "Download", "class": "flent", "method": "tcp_download"}, {"title": "Upload", "class": "flent", "method": "tcp_upload"}, {"title": "Bi-directional", "class": "flent", "method": "tcp_bidirectional"}]}, "file_name": "ubuntu_test.yaml"}}, "records": {"40500cc5-e32f-4df5-8476-dcc596b68a7a": {"status": "ok", "stderr": "", "start": 1618151482.03661, "finish": 1618151561.9457555, "command": {"type": "script", "data": "zcat `flent -H 40.0.0.25 -l 60 -s 1 tcp_download 2>&1 | grep \"file written\" | grep -Po \"\\./\\S+gz\"`"}, "meta": [["time", "s"], ["ping_icmp", "ms"], ["tcp_download", "Mbits/s"]], "samples": [[0.0, 1.58, null], [1.0, 1.13061477956649, null], [2.0, 1.6083316611846998, null], [3.0, 1.6199437518467468, null], [4.0, 1.7093029053698632, null], [5.0, 1.0560071357567606, null], [6.0, 0.9846743537716303, 12441.02], [7.0, 0.3210708276131641, 10660.989186401366], [8.0, 1.066205614086556, 11447.264484434128], [9.0, 3.8587067561987842, 10609.992194833754], [10.0, 0.5957954641307612, 11451.653308963774], [11.0, 0.6770777715347814, 12343.396625118256], [12.0, 0.7244174799367512, 11578.051055049897], [13.0, 0.8148452796327659, 11810.633025972622], [14.0, 0.7356186227551742, 11705.226588993071], [15.0, 0.7111079005009135, 11365.797242431641], [16.0, 0.8585117383821479, 11422.12267320633], [17.0, 0.4137039935690061, 11647.86961471081], [18.0, 279.1563815078253, 11430.908128890991], [19.0, 235.22998584692277, 4591.239396929741], [20.0, 0.6960522854544315, 10429.44715821743], [21.0, 1.0207287254430804, 9590.384735693931], [22.0, 1.4855311806096878, 10519.133626392104], [23.0, 1.132165715157933, 8528.728918094635], [24.0, 0.9767489429379487, 10201.188162708284], [25.0, 1.1362710506159526, 9420.706384792327], [26.0, 0.8390233276988075, 9181.893204460144], [27.0, 1.3848084422653968, 10712.511930122375], [28.0, 0.7094041226393383, 8238.462169532777], [29.0, 0.5331424272248309, 10500.575395569216], [30.0, 0.7209714054263556, 10549.661634423734], [31.0, 0.5594746538047126, 10737.046981716157], [32.0, 2.367228628993973, 9455.923093178273], [33.0, 1.9276378551671662, 6492.044306819438], [34.0, 0.805117743562624, 10395.292829065324], [35.0, 0.6033576390816016, 10234.143422677516], [36.0, 1.0791252337605641, 10087.539858996868], [37.0, 1.040527027432569, 10127.626521174909], [38.0, 0.5299134202858009, 9920.408657617876], [39.0, 0.6378787632382029, 9381.600462188722], [40.0, 1.5192874439266584, 8407.107906332016], [41.0, 1.3928925376720498, 9469.273307976722], [42.0, 0.6438897423238508, 8890.96866376023], [43.0, 0.7994165857944088, 9325.974628286362], [44.0, 0.7515217824292026, 8299.32715601921], [45.0, 0.42143205417692103, 7917.964900108098], [46.0, 0.6915176176477773, 9056.917706799508], [47.0, 0.9147758957814534, 9201.068461437226], [48.0, 1.2375376354552252, 9208.592132310867], [49.0, 1.2393324180518015, 9294.699021446704], [50.0, 0.7692901990381142, 9473.212708630563], [51.0, 0.8103209175854171, 9534.883703713416], [52.0, 1.2764079998971882, 9292.456569089889], [53.0, 1.2547325296471392, 8933.075182669163], [54.0, 0.9682714766679941, 9129.489055185319], [55.0, 1.2271512785176193, 9181.747017667294], [56.0, 1.7985299075197805, 7619.673551638127], [57.0, 1.5650442488637066, 7587.5540527629855], [58.0, 1.2062550892545836, 8361.57208206415], [59.0, 1.2293303659358843, 8064.681515987384], [60.0, 1.7155984120489127, 7998.0860545802125], [61.0, 1.701295650629707, 7664.67925753355], [62.0, 1.3139810800345288, 7830.71538288792], [63.0, 1.296923984540068, 7537.1714701390265], [64.0, 1.0398122192290253, 8638.752539870738], [65.0, 1.143967730440659, 8780.520422867137], [66.0, 1.3382768790651178, 8783.15], [67.0, 1.1055197273052504, null], [68.0, 0.9838501849467196, null], [69.0, 1.1763749355341486, null]], "schedule": 1618151482.0259218, "id": "40500cc5-e32f-4df5-8476-dcc596b68a7a", "agent": "test_primary_0", "node": "harrypotter", "concurrency": 1, "test": "Download", "executor": "flent", "type": "agent", "scenario": "OpenStack VNF test", "stats": {"ping_icmp": {"max": 279.1563815078253, "min": 0.3210708276131641, "avg": 8.422427864447812, "unit": "ms"}, "tcp_download": {"max": 12441.02, "min": 4591.239396929741, "avg": 9552.35733493676, "unit": "Mbits/s"}}}, "846b5b69-f149-4377-abdd-464d182635f0": {"status": "ok", "stderr": "", "start": 1618151582.325286, "finish": 1618151657.783413, "command": {"type": "script", "data": "zcat `flent -H 40.0.0.25 -l 60 -s 1 tcp_upload 2>&1 | grep \"file written\" | grep -Po \"\\./\\S+gz\"`"}, "meta": [["time", "s"], ["ping_icmp", "ms"], ["tcp_upload", "Mbits/s"]], "samples": [[0.0, 0.984, null], [1.0, 1.7783540223102812, null], [2.0, 1.5409660468732043, null], [3.0, 1.5101734236115723, null], [4.0, 1.4008329650416853, null], [5.0, 0.3382055655086702, null], [6.0, 0.22783948164474496, 10146.12], [7.0, 0.8003435983757795, 10955.604853875158], [8.0, 0.6422581268237699, 10926.318966064453], [9.0, 1.8157079020023827, 10340.917331881525], [10.0, 0.44614850194154343, 10943.57472129345], [11.0, 0.463250501762747, 10887.128202056885], [12.0, 1.3625768518744659, 10633.384203896523], [13.0, 1.0901067107727065, 10711.58881708145], [14.0, 0.7990205000179835, 10483.476395596712], [15.0, 1.4079307025530252, 10577.91502960205], [16.0, 1.057819906990699, 8630.033968505859], [17.0, 0.9402750700829756, 9344.062647781371], [18.0, 0.28643565734326093, 9812.876302719116], [19.0, 0.6875372979132344, 10226.152475738525], [20.0, 0.2614881594388644, 10014.183237134726], [21.0, 0.42560935313258375, 9672.994986505508], [22.0, 0.8653640652651492, 9305.252850677967], [23.0, 1.4915755553345047, 9760.215470275878], [24.0, 1.935377894881828, 8961.575876002313], [25.0, 0.8979970900776226, 9062.580218796731], [26.0, 0.7889523631654379, 8408.115505871774], [27.0, 0.8839047659734565, 8845.600463192462], [28.0, 0.5362876430460053, 9147.559363102913], [29.0, 0.8134540584834866, 9597.781412844657], [30.0, 0.7994782057719665, 9846.06706139803], [31.0, 1.2108586818578533, 10062.466016514301], [32.0, 1.3285288496606678, 10326.599919312], [33.0, 0.8882210817306833, 9866.271811640263], [34.0, 0.8722152240342078, 9223.661662664412], [35.0, 0.5685233179351465, 9258.649280200005], [36.0, 0.5997374007476785, 10404.58218129635], [37.0, 0.666398628471115, 9258.089138674737], [38.0, 0.9410804104478915, 9465.686259708405], [39.0, 1.1263303424425146, 9213.50837772937], [40.0, 1.288664984473713, 9207.156464579106], [41.0, 0.6204831707645602, 9557.814362404346], [42.0, 0.617388755968107, 9486.807572641374], [43.0, 0.4478949127744436, 9478.17784475565], [44.0, 0.9986641686585626, 9237.770329787732], [45.0, 1.212008885688898, 9960.08528295517], [46.0, 0.7136660929792763, 10085.87365705967], [47.0, 0.6042395223222645, 9456.436210272312], [48.0, 0.6101876438091681, 9559.728211591244], [49.0, 0.8063417083509142, 9156.12546648264], [50.0, 1.057355097592037, 9394.194122657675], [51.0, 0.9866621743192978, 7785.81293982029], [52.0, 0.9175006962884384, 7267.257821252346], [53.0, 0.9443437012641407, 9630.927795436382], [54.0, 0.7001066085151957, 9947.696532337664], [55.0, 0.5280237325200003, 9561.095186169146], [56.0, 0.526062913024476, 9988.442039003374], [57.0, 0.7881516682746927, 9398.581854600905], [58.0, 0.7488071884553095, 9686.48406267643], [59.0, 0.6765926490405157, 9096.721228694916], [60.0, 0.8833791866755386, 9366.870331659004], [61.0, 0.5658203808969217, 10041.48932015419], [62.0, 0.559436696277161, 9051.4445419693], [63.0, 0.9931898017537437, 8910.842735900878], [64.0, 1.3292408296195946, 8926.23388621807], [65.0, 1.0238437795831878, 8851.269508559637], [66.0, 1.194508951337237, 8850.53], [67.0, 1.2898649200476318, null], [68.0, 1.5174138353254758, null], [69.0, 1.3028459687682667, null]], "schedule": 1618151582.3146567, "id": "846b5b69-f149-4377-abdd-464d182635f0", "agent": "test_primary_0", "node": "harrypotter", "concurrency": 1, "test": "Upload", "executor": "flent", "type": "agent", "scenario": "OpenStack VNF test", "stats": {"ping_icmp": {"max": 1.935377894881828, "min": 0.22783948164474496, "avg": 0.9133408078673164, "unit": "ms"}, "tcp_upload": {"max": 10955.604853875158, "min": 7267.257821252346, "avg": 9594.466628184844, "unit": "Mbits/s"}}}, "27371eb0-a90c-4c70-82bf-df1860eb27bd": {"status": "ok", "stderr": "", "start": 1618151678.1578462, "finish": 1618151753.6183357, "command": {"type": "script", "data": "zcat `flent -H 40.0.0.25 -l 60 -s 1 tcp_bidirectional 2>&1 | grep \"file written\" | grep -Po \"\\./\\S+gz\"`"}, "meta": [["time", "s"], ["ping_icmp", "ms"], ["tcp_download", "Mbits/s"], ["tcp_upload", "Mbits/s"]], "samples": [[0.0, 1.14, null, null], [1.0, 2.1673966665810527, null, null], [2.0, 1.6817927602006078, null, null], [3.0, 1.3716806188894073, null, null], [4.0, 1.399782510088082, null, null], [5.0, 0.862515865271832, null, null], [6.0, 0.7916559089866992, 6650.46, 6305.21], [7.0, 0.7871261939550582, 6955.95384517908, 6052.608592412472], [8.0, 0.2158102007238304, 6298.8705759859085, 5796.548029243946], [9.0, 0.40430569799588245, 6163.314272608225, 5376.564429056644], [10.0, 1.2012942618874956, 6652.093419523239, 5613.850489306449], [11.0, 2.0758986883250894, 4770.019228057861, 4188.566973156929], [12.0, 3.2475712096472322, 5537.838970822423, 5470.92419011116], [13.0, 1.2440964065620674, 5752.735494089126, 5616.477953467369], [14.0, 0.8985228609211227, 6050.611557703018, 5610.380320681272], [15.0, 0.7412747356094801, 6072.728057548199, 5432.317898979187], [16.0, 3.3548263642471077, 5665.220784745216, 5516.864177265167], [17.0, 1.676820071757418, 5187.903078904153, 4678.941561393738], [18.0, 0.47061305968566625, 5680.00248544693, 5197.576846141816], [19.0, 1.1334995008442599, 5481.677803826332, 5341.077121543884], [20.0, 0.34430014786313456, 5429.323734140396, 4471.080377531051], [21.0, 1.3498326410294856, 5621.445364874379, 5485.146480026245], [22.0, 1.1815473539414838, 5553.825371789932, 5058.292196702958], [23.0, 1.6649116650564098, 5481.724897017479, 4948.614265298844], [24.0, 2.1254486654348668, 5052.916059955251, 4998.130723630212], [25.0, 0.5433081077664044, 5156.774199956746, 5079.043681411744], [26.0, 3.1884586777910733, 5354.604106733799, 4854.435086755752], [27.0, 0.8088826313092783, 4951.222917926311, 4793.010225481987], [28.0, 0.81514273458158, 4858.824927346706, 4622.349805335998], [29.0, 0.3994325143635489, 4999.714522475571, 4678.149886393547], [30.0, 0.8886035542397446, 5168.166828620434, 4865.759970335961], [31.0, 1.047982876784085, 4814.51350877285, 4322.235173878848], [32.0, 0.9256419943588416, 4965.63497420311, 4807.533252639771], [33.0, 2.244172745869618, 4900.855855813026, 4811.479657821656], [34.0, 1.2810243644070323, 4970.274191400307, 4438.719361648559], [35.0, 2.173255049388106, 4931.270343956338, 4424.149887495508], [36.0, 2.124632400279465, 4745.400896735191, 4562.2870961833], [37.0, 1.807869125546874, 4500.752353867473, 4360.487041435242], [38.0, 2.517299698919743, 4486.13282497406, 4613.803689477444], [39.0, 1.758922312858957, 4514.433439238642, 4099.525444188118], [40.0, 1.5525581997536257, 4680.51834653616, 4019.81075173378], [41.0, 5.767380525305961, 4683.045566626445, 4277.363681995868], [42.0, 2.606970144779525, 4461.256430039981, 4271.066458954811], [43.0, 1.6321916026236805, 4500.350274281502, 3824.981269161701], [44.0, 2.1208449318380533, 4271.183490728472, 4594.476237308979], [45.0, 2.9198328525613206, 4711.908307991028, 4323.231461400986], [46.0, 3.0198971515657007, 4190.6930832290645, 4192.12663743019], [47.0, 0.998287473940771, 4119.572513942719, 4059.5494852489787], [48.0, 3.4065348231789874, 3579.4665450668335, 3389.1922893749315], [49.0, 3.822666223388432, 3467.1527608444735, 3434.661976815818], [50.0, 2.1894960328809443, 3522.419494891167, 3410.398240048102], [51.0, 3.025143182547702, 4163.18364759969, 3743.443186659813], [52.0, 2.8483479774032294, 4460.513594026565, 3992.4992616168925], [53.0, 1.6871919691038741, 4588.635763940811, 3933.4329302383853], [54.0, 0.5885332335678934, 4654.559843187332, 4105.585289440155], [55.0, 1.2267088737022933, 4651.536779794693, 4270.198006868362], [56.0, 1.6225592976402248, 4594.942962363454, 4022.38702354908], [57.0, 2.1775779861316207, 4599.404042320251, 3877.9800671276407], [58.0, 2.0961756474809343, 4904.255660665035, 4185.302573223114], [59.0, 1.0981352809192377, 4392.022129942661, 4131.726819763184], [60.0, 2.330183459146575, 4751.292137151957, 3955.89622297287], [61.0, 2.4783421188315273, 4126.090355496407, 4149.583917617798], [62.0, 4.026332437544159, 4049.1582453012866, 4051.7118579528633], [63.0, 3.324072801378045, 4270.366584300995, 4124.053202955723], [64.0, 3.7621445165628797, 4343.154441944131, 3870.842117714478], [65.0, 2.332567096612964, 4228.291752652004, 3397.6739864348374], [66.0, 1.3864296236230247, 4225.77, 3389.96], [67.0, 1.3190913003251248, null, null], [68.0, 0.8900847621399839, null, null], [69.0, 1.086277820547855, null, null]], "schedule": 1618151678.1471345, "id": "27371eb0-a90c-4c70-82bf-df1860eb27bd", "agent": "test_primary_0", "node": "harrypotter", "concurrency": 1, "test": "Bi-directional", "executor": "flent", "type": "agent", "scenario": "OpenStack VNF test", "stats": {"ping_icmp": {"max": 5.767380525305961, "min": 0.2158102007238304, "avg": 1.7914244598713613, "unit": "ms"}, "tcp_download": {"max": 6955.95384517908, "min": 3467.1527608444735, "avg": 4927.344027034472, "unit": "Mbits/s"}, "tcp_upload": {"max": 6305.21, "min": 3389.1922893749315, "avg": 4549.037325246592, "unit": "Mbits/s"}}}, "67dacb1a-5003-4596-be8f-41a7d49984a1": {"stats": {"ping_icmp": {"unit": "ms", "avg": 8.422427864447812, "max": 279.1563815078253, "min": 0.3210708276131641}, "tcp_download": {"unit": "Mbits/s", "avg": 9552.35733493676, "max": 12441.02, "min": 4591.239396929741}}, "node_chart": [["x", "harrypotter"], ["Avg ping_icmp, ms", 8.422427864447812], ["Max ping_icmp, ms", 279.1563815078253], ["Min ping_icmp, ms", 0.3210708276131641], ["Avg tcp_download, Mbits/s", 9552.35733493676], ["Max tcp_download, Mbits/s", 12441.02], ["Min tcp_download, Mbits/s", 4591.239396929741]], "id": "67dacb1a-5003-4596-be8f-41a7d49984a1", "scenario": "OpenStack VNF test", "test": "Download", "concurrency": 1, "type": "concurrency"}, "121ebf72-7756-4444-8009-10efb37fc5ca": {"chart": [["concurrency", 1], ["ping_icmp", 8.422427864447812], ["tcp_download", 9552.35733493676]], "meta": [["concurrency", ""], ["ping_icmp", "ms"], ["tcp_download", "Mbits/s"]], "id": "121ebf72-7756-4444-8009-10efb37fc5ca", "scenario": "OpenStack VNF test", "test": "Download", "type": "test"}, "0c49e29e-19d3-4a49-8ff4-d945f193e5f7": {"stats": {"ping_icmp": {"unit": "ms", "avg": 0.9133408078673164, "max": 1.935377894881828, "min": 0.22783948164474496}, "tcp_upload": {"unit": "Mbits/s", "avg": 9594.466628184844, "max": 10955.604853875158, "min": 7267.257821252346}}, "node_chart": [["x", "harrypotter"], ["Avg ping_icmp, ms", 0.9133408078673164], ["Max ping_icmp, ms", 1.935377894881828], ["Min ping_icmp, ms", 0.22783948164474496], ["Avg tcp_upload, Mbits/s", 9594.466628184844], ["Max tcp_upload, Mbits/s", 10955.604853875158], ["Min tcp_upload, Mbits/s", 7267.257821252346]], "id": "0c49e29e-19d3-4a49-8ff4-d945f193e5f7", "scenario": "OpenStack VNF test", "test": "Upload", "concurrency": 1, "type": "concurrency"}, "5b28de6f-80e2-4276-87a1-1e2de9564780": {"chart": [["concurrency", 1], ["ping_icmp", 0.9133408078673164], ["tcp_upload", 9594.466628184844]], "meta": [["concurrency", ""], ["ping_icmp", "ms"], ["tcp_upload", "Mbits/s"]], "id": "5b28de6f-80e2-4276-87a1-1e2de9564780", "scenario": "OpenStack VNF test", "test": "Upload", "type": "test"}, "4bbd4135-c9a2-4a4a-a5b6-331da2ded088": {"stats": {"ping_icmp": {"unit": "ms", "avg": 1.7914244598713613, "max": 5.767380525305961, "min": 0.2158102007238304}, "tcp_download": {"unit": "Mbits/s", "avg": 4927.344027034472, "max": 6955.95384517908, "min": 3467.1527608444735}, "tcp_upload": {"unit": "Mbits/s", "avg": 4549.037325246592, "max": 6305.21, "min": 3389.1922893749315}}, "node_chart": [["x", "harrypotter"], ["Avg ping_icmp, ms", 1.7914244598713613], ["Max ping_icmp, ms", 5.767380525305961], ["Min ping_icmp, ms", 0.2158102007238304], ["Avg tcp_download, Mbits/s", 4927.344027034472], ["Max tcp_download, Mbits/s", 6955.95384517908], ["Min tcp_download, Mbits/s", 3467.1527608444735], ["Avg tcp_upload, Mbits/s", 4549.037325246592], ["Max tcp_upload, Mbits/s", 6305.21], ["Min tcp_upload, Mbits/s", 3389.1922893749315]], "id": "4bbd4135-c9a2-4a4a-a5b6-331da2ded088", "scenario": "OpenStack VNF test", "test": "Bi-directional", "concurrency": 1, "type": "concurrency"}, "2cae50a8-9e08-420f-a174-c7944687ab6d": {"chart": [["concurrency", 1], ["ping_icmp", 1.7914244598713613], ["tcp_download", 4927.344027034472], ["tcp_upload", 4549.037325246592]], "meta": [["concurrency", ""], ["ping_icmp", "ms"], ["tcp_download", "Mbits/s"], ["tcp_upload", "Mbits/s"]], "id": "2cae50a8-9e08-420f-a174-c7944687ab6d", "scenario": "OpenStack VNF test", "test": "Bi-directional", "type": "test"}}, "agents": {"test_primary_0": {"id": "test_primary_0", "mode": "primary", "minion_id": "test_minion_0", "node": "harrypotter", "zone": "nova", "availability_zone": "nova:harrypotter", "ip": "30.0.0.25", "minion": {"id": "test_minion_0", "mode": "minion", "primary_id": "test_primary_0", "node": "harrypotter", "zone": "nova", "availability_zone": "nova:harrypotter", "ip": "40.0.0.25"}}, "test_minion_0": {"id": "test_minion_0", "mode": "minion", "primary_id": "test_primary_0", "node": "harrypotter", "zone": "nova", "availability_zone": "nova:harrypotter", "ip": "40.0.0.25", "primary": {"id": "test_primary_0", "mode": "primary", "minion_id": "test_minion_0", "node": "harrypotter", "zone": "nova", "availability_zone": "nova:harrypotter", "ip": "30.0.0.25"}}}, "tests": {"Download": {"title": "Download", "class": "flent", "method": "tcp_download"}, "Upload": {"title": "Upload", "class": "flent", "method": "tcp_upload"}, "Bi-directional": {"title": "Bi-directional", "class": "flent", "method": "tcp_bidirectional"}}, "sla": []};
  </script>

  <script type="text/javascript">
    "use strict";

    $(function () {

      var fields = ["scenario", "test", "concurrency", "node", "agent"];
      var state = {
        scenario: "",
        test: "",
        concurrency: "",
        node: "",
        agent: ""
      };
      var tablePageSize = 10;

      // compiled templates
      var scenario_source_template = Handlebars.compile($("#scenario_source_template").html());
      var test_specification_template = Handlebars.compile($("#test_specification_template").html());
      var agents_table_template = Handlebars.compile($("#agents_table_template").html());
      var records_table_template = Handlebars.compile($("#records_table_template").html());
      var executor_template = Handlebars.compile($("#executor_template").html());
      var concurrency_summary_template = Handlebars.compile($("#concurrency_summary_template").html());
      var test_summary_template = Handlebars.compile($("#test_summary_template").html());
      var sla_table_template = Handlebars.compile($("#sla_table_template").html());
      var errors_template = Handlebars.compile($("#errors_template").html());

      function concatenate(strings) {
        // returns strings concatenated via comma (like join() but omits empty strings)
        var f = false;
        var result = "";
        $.each(strings, function (_i, string) {
          if (string.length > 0) {
            if (f) result += ", ";
            result += string;
            f = true;
          }
        });
        return result;
      }

      function initSingleSelector(name, values) {
        var selectorId = "#" + name + "_selector";

        var selector_inst = $(selectorId);
        selector_inst.empty();
        selector_inst.append($("<option>", {
          style: "font-style: italic; text-decoration: underline;",
          value: "",
          text: selector_inst.data('placeholder')
        }));

        $.each(values, function (key, item) {
          selector_inst.append($('<option>', {
            value: item, //(key + 1),
            text: item
          }));
        });

        selector_inst.val(state[name]);

        selector_inst.
            on("change", function (e) {
              state[name] = this.value;

              // convert state -> url
              var tokens = [];
              $.each(fields.sort(), function (i, field) {
                if (state[field] != "") {
                  tokens.push(field + "=" + state[field]);
                }
              });
              window.location.href = "#" + tokens.join(":");
            });
      }

      function getFieldValues(field, records) {
        var values_set = {};

        $.each(records, function (j, record) {
          if (record[field]) {
            values_set["" + record[field]] = true;
          }
        });

        return $.map(values_set, function (_i, value) {
          return value;
        }).sort();
      }

      function updateSelectors() {
        $.each(fields, function (i, field) {
          var values = getFieldValues(field, filterRecords(report.records, null, field));
          console.log(values);
          initSingleSelector(field, values);
        });
      }

      function filterRecords(records, type, except_field) {
        var res = [];
        $.each(records, function(_i, record){
          if (!type || typeof type === 'undefined' || record.type == type) {
            var flag = true;
            $.each(state, function (key, value) {
              if (key != except_field && value) {
                flag &= record[key] == value;
              }
            });
            if (flag) {
              res.push(record);
            }
          }
        });
        return res;
      }

      function getAgentsByIds(agent_ids) {
        var agents = [];
        $.each(agent_ids, function(agent_id){
          agents.push(report.agents[agent_id]);
        });
        return agents;
      }

      /* Template Rendering Funcs */

      function showScenarioSource(contentArea, scenario) {
        contentArea.append(scenario_source_template(
            {data: jsyaml.safeDump(scenario)}));
      }

      function showTestSpecification(contentArea, test) {
        contentArea.append(test_specification_template(
            {data: jsyaml.safeDump(test)}
        ))
      }

      function showAgentRecord(contentArea, record) {
        var chart_id = "chart_" + Math.round(Math.random() * 10000);
        var ext_options = {
          command_yaml: jsyaml.safeDump(record["command"]),
          chart_id: chart_id};
        if (record["stats"]) {
          ext_options["stats_yaml"] = jsyaml.safeDump(record["stats"]);
        }
        if ((record["start"]) && (record["finish"])) {
          ext_options["time_info"] = jsyaml.safeDump({
            "start": new Date(record["start"] * 1000).toISOString(),
            "finish": new Date(record["finish"] * 1000).toISOString()
          });
        }
        contentArea.append(executor_template(
            {record: $.extend({}, record, ext_options)}
        ));
        if (record["samples"]) {
          var meta = record["meta"];
          var axes = [];
          axes[meta[1][0]] = 'y';
          var axis = {
            x: {label: concatenate(meta[0])},
            y: {label: concatenate(meta[1]), min: 0}
          };
          if (meta.length > 2) {
            axes[meta[2][0]] = 'y2';
            axis['y2'] = {label: concatenate(meta[2]), min: 0, show: true}
          }

          var chart = [];
          $.each(meta, function(_i, meta_item){  // row titles
            chart.push([meta_item[0]]);
          });
          var samples = record["samples"];
          for (var i=0; i < samples.length; i++) {
            var point = samples[i];
            for (var j=0; j < point.length; j++) {
              chart[j].push(point[j]);
            }
          }

          c3.generate({
            bindto: "#" + chart_id,
            data: {
              x: 'time',
              columns: chart,
              axes: axes
            },
            axis: axis
          });
        }
      }

      function showConcurrencySummary(contentArea, record) {
        var chart_id = "chart_" + Math.round(Math.random() * 10000);
        var node_chart_id = "node_chart_" + Math.round(Math.random() * 10000);
        var ext_options = { chart_id: chart_id, node_chart_id: node_chart_id };
        if (record["stats"]) {
          ext_options["stats_yaml"] = jsyaml.safeDump(record["stats"]);
        }
        console.log(record);
        contentArea.append(concurrency_summary_template(
            {record: $.extend({}, record, ext_options)}
        ));
        if (record["node_chart"]) {
          c3.generate({
            bindto: "#" + node_chart_id,
            data: {
              x: 'x',
              columns: record["node_chart"],
              type: 'step',
              order: null
            },
            axis: {
              x: { type: 'category' }
            }
          });
        }
      }

      function showTestSummary(contentArea, record) {
        console.log(record);
        var chart_id = "chart_" + Math.round(Math.random() * 10000);
        var ext_options = { chart_id: chart_id };
        if (record["stats"]) {
          ext_options["stats_yaml"] = jsyaml.safeDump(record["stats"]);
        }
        contentArea.append(test_summary_template(
            {record: $.extend({}, record, ext_options)}
        ));
        if (record["chart"]) {
          var meta = record["meta"];
          var axes = [];
          axes[meta[1][0]] = 'y';
          var axis = {
            x: {label: concatenate(meta[0])},
            y: {label: concatenate(meta[1]), min: 0}
          };
          if (meta.length > 2) {
            axes[meta[2][0]] = 'y2';
            axis['y2'] = {label: concatenate(meta[2]), min: 0, show: true}
          }

          c3.generate({
            bindto: "#" + chart_id,
            data: {
              x: 'concurrency',
              columns: record["chart"],
              axes: axes
            },
            axis: axis
          });
        }
      }

      function showAgentsTable(contentArea, filteredRecords) {
        var agent_ids = {};
        $.each(filteredRecords, function(_i, record){
          if (record.agent) {
            agent_ids[record.agent] = true;
          }
        });

        var agents = getAgentsByIds(agent_ids);
        if (agents.length == 0) return;

        // add minion agents
        var minion_agent_ids = {};
        $.each(agents, function(_i, agent){
          if (agent.minion_id) {
            minion_agent_ids[agent.minion_id] = true;
          }
        });
        agents = $.merge(agents, getAgentsByIds(minion_agent_ids));

        contentArea.append(agents_table_template({
          agents: agents,
          table_id: "agents_table"
        }));
        $("#agents_table").dataTable({
          "autoWidth": true,
          "paging": false,
          "ordering": true,
          "info": false
        });
      }

      function makeURL(record, s) {
        var extra = {};
        extra[s] = record[s];
        return "#" + $.map($.extend({}, state, extra), function (val, index) {
          return val? (index + "=" + val) : null;
        }).join(":")
      }

      function showRecordsTable(contentArea, filteredRecords) {
        $.each(filteredRecords, function(_i, record) {
          $.each(fields, function(_j, field){
            if (record[field]) {
              record[field + "_url"] = makeURL(record, field);
            }
          });
        });

        contentArea.append(records_table_template({
          records: filteredRecords,
          table_id: "records_table"
        }));
        $("#records_table").dataTable({
          autoWidth: true,
          paging: filteredRecords.length > tablePageSize,
          ordering: true,
          info: false,
          searching: filteredRecords.length > tablePageSize
        });
      }

      function showSlaTable(contentArea, records) {
        if (records.length == 0) return;

        contentArea.append(sla_table_template({
          records: records,
          table_id: "sla_table"
        }));
        $("#records_table").dataTable({
          autoWidth: true,
          paging: records.length > tablePageSize,
          ordering: true,
          info: false,
          searching: records.length > tablePageSize
        });
      }

      function showErrors(contentArea, records) {
        if (records.length == 0) return;

        contentArea.append(errors_template({
          records: records,
          table_id: "errors_list"
        }));
      }

      /* Update cycle */

      function update() {
        var filteredRecords = filterRecords(report.records);
        console.log(filteredRecords);
        var slaRecords = [];
        var errorRecords = [];
        $.each(filterRecords(report.records), function(_i, record) {
          if (record["sla_info"]) {
            slaRecords.push(record);
          }
          if (record["is_status_error"]) {
            errorRecords.push(record);
          }
        });

        var contentArea = $("#content_area");
        contentArea.empty();

        updateSelectors();

        showRecordsTable(contentArea, filteredRecords);
        showSlaTable(contentArea, slaRecords);
        showErrors(contentArea, errorRecords);

        if (state["scenario"] != "" && state["test"] != "" &&
                state["concurrency"] != "" &&
                state["agent"] != "") {
          showAgentRecord(contentArea, filteredRecords[0]);
        }
        if (state["scenario"] != "" && state["test"] != "" &&
                state["concurrency"] != "" && state["node"] == "" &&
                state["agent"] == "") {
          var agg_recs = filterRecords(report.records, "concurrency");
          if (agg_recs.length > 0) {
            showConcurrencySummary(contentArea, agg_recs[0]);
          }
        }
        if (state["scenario"] != "" && state["test"] != "" &&
                state["concurrency"] == "" && state["node"] == "" &&
                state["agent"] == "") {
          var test_recs = filterRecords(report.records, "test");
          if (test_recs.length > 0) {
            showTestSummary(contentArea, test_recs[0]);
          }
        }
        if (state["test"] != "") {
          showTestSpecification(contentArea, report.tests[state["test"]]);
        }
        if (state["agent"] == "") {
          showAgentsTable(contentArea, filteredRecords);
        }
        if (state["scenario"] != "") {
          showScenarioSource(contentArea, report.scenarios[state["scenario"]]);
        }
      }

      function parseUrlToState() {
        var hashUrl = window.location.hash.substr(1);

        $.each(hashUrl.split(":"), function (_i, pair) {
          var kv = pair.split("=");
          if (kv.length == 2) {
            state[kv[0]] = decodeURIComponent(kv[1]);
          }
        });
      }

      // entry-point
      parseUrlToState();
      console.log(state);

      // change the status of tests that have sla failures
      // to "fail", only if they were previously marked "ok"
      $.each(report.sla, function(_i, sla) {
        if (sla.state == "FAIL" && report.records[sla.record].status == "ok") {
          report.records[sla.record].status = "fail";
        }
      });
      // pre-process records
      $.each(report.records, function(_i, record) {
        if (record.status) {
          record["is_status_ok"] = record.status == "ok";
          record["is_status_lost"] = record.status == "lost";
          record["is_status_interrupted"] = record.status == "interrupted";
          record["is_status_error"] = record.status == "error";
          record["is_status_fail"] = record.status == "fail";
        }
      });

      // auto-select filters with 1 option
      $.each(fields, function(_i, field) {
        var values = getFieldValues(field, report.records);
        if (values.length == 1) {
          state[field] = values[0];
        }
      });

      update();

      $(window).on('hashchange', function() {
        parseUrlToState();
        update()
      });

      $('[data-toggle="tooltip"]').tooltip();
    });
  </script>

  <style type="text/css">
  </style>

</head>

<body>

<div class="container" id="container">
  <div class="row text-center">
    <h1>Shaker | The Report</h1>
  </div>
  <hr>
  <div class="row">
    <div class="col-md-2">
      <label for="scenario_selector" title="Scenario name">Scenario</label>
      <select id="scenario_selector" class="form-control" data-placeholder="- Any scenario -"></select>
    </div>
    <div class="col-md-2">
      <label for="test_selector" title="Test name">Test Case</label>
      <select id="test_selector" class="form-control" data-placeholder="- Any test case -"></select>
    </div>
    <div class="col-md-2">
      <label for="concurrency_selector" title="Concurrency">Concurrency</label>
      <select id="concurrency_selector" class="form-control" data-placeholder="- Any concurrency -"></select>
    </div>
    <div class="col-md-2">
      <label for="node_selector" title="Host / Compute node">Host</label>
      <select id="node_selector" class="form-control" data-placeholder="- Any node -"></select>
    </div>
    <div class="col-md-2">
      <label for="agent_selector" title="Agent">Agent</label>
      <select id="agent_selector" class="form-control" data-placeholder="- Any agent -"></select>
    </div>
  </div>

  <div id="content_area" class="row">
    <!-- Container for the screen content -->
  </div>

  <div id="footer" class="row">&nbsp;</div>
</div>

<!-- TEMPLATES --------------------------------------------------------------->

<!-- Scenario File -->
<script id="scenario_source_template" type="text/x-handlebars-template">
  <h3>Scenario</h3>
  <pre>{{ data }}</pre>
</script>

<!-- Test Specification -->
<script id="test_specification_template" type="text/x-handlebars-template">
  <h3>Test Specification</h3>
  <pre>{{ data }}</pre>
</script>

<!-- Executor Result -->
<script id="executor_template" type="text/x-handlebars-template">
  <h3>Execution Summary</h3>
  {{#with record}}
  <div id="{{ chart_id }}"></div>
  {{#if is_status_ok}}<span class="label label-success"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span>success</span>{{/if}}
  {{#if is_status_lost}}<span class="label label-danger"><span class="glyphicon glyphicon-alert" aria-hidden="true"></span>lost</span>{{/if}}
  {{#if is_status_interrupted}}<span class="label label-warning"><span class="glyphicon glyphicon-stop" aria-hidden="true"></span>interrupted</span>{{/if}}
  {{#if is_status_error}}<span class="label label-danger"><span class="glyphicon glyphicon-alert" aria-hidden="true"></span>error</span>{{/if}}
  {{#if is_status_fail}}<span class="label label-danger"><span class="glyphicon glyphicon-alert" aria-hidden="true"></span>sla fail</span>{{/if}}
  {{#if stats_yaml}}
    <h4>Stats</h4>
    <pre>{{ stats_yaml }}</pre>
  {{/if}}
  {{#if time_info}}
    <h4>Time Info</h4>
    <pre>{{ time_info }}</pre>
  {{/if}}
  <h4>Command</h4>
  <pre>{{ command_yaml }}</pre>
  {{#if stdout}}
    <h4>Stdout</h4>
    <pre>{{ stdout }}</pre>
  {{/if}}
  {{#if verbose}}
    <h4>Verbose Info</h4>
    <pre>{{ verbose }}</pre>
  {{/if}}
  {{#if stderr}}
    <h4>Stderr</h4>
    <pre>{{ stderr }}</pre>
  {{/if}}
  {{/with}}
</script>

<!-- Concurrency summary -->
<script id="concurrency_summary_template" type="text/x-handlebars-template">
  {{#with record}}
  <div id="{{ chart_id  }}"></div>
  <h3>Per-node chart</h3>
  <div id="{{ node_chart_id  }}"></div>
  <h3>Stats</h3>
  <pre>{{ stats_yaml }}</pre>
  {{/with}}
</script>

<!-- Test summary -->
<script id="test_summary_template" type="text/x-handlebars-template">
  {{#with record}}
  <div id="{{ chart_id   }}"></div>
  {{#if stats_yaml}}
    <h3>Stats</h3>
    <pre>{{ stats_yaml }}</pre>
  {{/if}}
  {{/with}}
</script>

<!-- Records Table -->
<script id="records_table_template" type="text/x-handlebars-template">
  <h3>Records</h3>
  <table class="table table-striped" id="{{ table_id  }}">
    <thead>
    <tr>
      <th>Scenario</th>
      <th>Test Case</th>
      <th>Concurrency</th>
      <th>Host / Compute Node</th>
      <th>Agent</th>
      <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {{#records}}
    <tr>
      <td><a href="{{ scenario_url }}">{{ scenario }}</a></td>
      <td><a href="{{ test_url }}">{{ test }}</a></td>
      <td><a href="{{ concurrency_url }}">{{ concurrency }}</a></td>
      <td><a href="{{ node_url }}">{{ node }}</a></td>
      <td><a href="{{ agent_url }}">{{ agent }}</a></td>
      <td>
        {{#if is_status_ok }}
          <span class="label label-success">
            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
            success
          </span>
        {{/if}}
        {{#if is_status_lost }}
          <span class="label label-danger">
            <span class="glyphicon glyphicon-alert" aria-hidden="true"></span>
            lost
          </span>
        {{/if}}
        {{#if is_status_interrupted }}
          <span class="label label-warning">
            <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
            interrupted
          </span>
        {{/if}}
        {{#if is_status_error }}
          <span class="label label-danger">
            <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
            error
          </span>
        {{/if}}
        {{#if is_status_fail }}
          <span class="label label-danger">
            <span class="glyphicon glyphicon-alert" aria-hidden="true"></span>
            sla fail
          </span>
        {{/if}}
      </td>
    </tr>
    {{/records}}
    </tbody>
  </table>
</script>

<!-- Agents List -->
<script id="agents_table_template" type="text/x-handlebars-template">
  <h3>Agents</h3>
  <table class="table table-striped" id="{{ table_id }}">
    <thead>
    <tr>
      <th>Agent</th>
      <th>Mode</th>
      <th>IP</th>
      <th>Node</th>
      <th>AZ</th>
    </tr>
    </thead>
    <tbody>
    {{#agents}}
    <tr>
      <td>{{ id }}</td>
      <td>{{ mode }}</td>
      <td>{{ ip }}</td>
      <td>{{ node }}</td>
      <td>{{ zone }}</td>
    </tr>
    {{/agents}}
    </tbody>
  </table>
</script>

<!-- SLA List -->
<script id="sla_table_template" type="text/x-handlebars-template">
  <h3>Agents</h3>
  <table class="table table-striped" id="{{  table_id }}">
    <thead>
    <tr>
      <th>Condition</th>
      <th>Location</th>
      <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {{#records}}
    <tr>
      <td>{{ sla }}</td>
      <td>{{ location }}</td>
      <td>
        {{#if is_status_ok }}
          <span class="text-success">
            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
            {{ status }}
          </span>
        {{else}}
          <span class="text-danger">
            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            {{ status }}
          </span>
        {{/if}}
      </td>
    </tr>
    {{/records}}
    </tbody>
  </table>
</script>

<!-- Errors -->
<script id="errors_template" type="text/x-handlebars-template">
  <h3>Errors</h3>
  <div class="text-danger">
    <ul>
    {{#records}}
      <li>{{ info }}<br/>{{ stderr }}{{ traceback }}</li>
    {{/records}}
    </ul>
  </div>
</script>

</body>
</html>